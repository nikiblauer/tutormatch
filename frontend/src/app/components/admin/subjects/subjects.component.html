<div class="pt-5">
  <!-- Add this alert to display error messages -->
  <div class="row p-2 justify-content-center error-pos" *ngIf="showErrorMessage">
    <div class="card col-11 col-sm-10 col-md-8 shadow alert alert-danger" role="alert" style="border: none;">
      <div class="row justify-content-end">
        <button type="button" class="btn-close" aria-label="Close" (click)="closeErrorMessage()"></button>
      </div>
      <div class="card-body p-2 p-md-3">
        <div class="row justify-content-center">
          <h2 class="mb-2 px-3 px-md-5 text-center">Error </h2>
          <p class="mb-3 mb-md-5 px-3 px-md-5  text-center text-muted">{{ message }}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Add this alert to display success messages -->
  <div class="row p-2 justify-content-center error-pos" *ngIf="showSuccessMessage">
    <div class="card col-11 col-sm-10 col-md-8 shadow alert alert-success" role="alert" style="border: none;">
      <div class="row justify-content-end">
        <button type="button" class="btn-close" aria-label="Close" (click)="closeSuccessMessage()"></button>
      </div>
      <div class="card-body p-2 p-md-3">
        <div class="row justify-content-center">
          <h2 class="mb-2 px-3 px-md-5 text-center">Success </h2>
          <p class="mb-3 mb-md-5 px-3 px-md-5  text-center text-muted">{{ message }}</p>
        </div>
      </div>
    </div>
  </div>
  <div class="row align-items-center justify-content-center">
    <h3 class="row mb-5">All Subjects:</h3>
    <div class="mb-4 input-group">
      <input type="text" placeholder="Search Subjects ..." [(ngModel)]="searchQuery"
             (input)="onSearchChange()" class="form-control mb-2">
    </div>
    <div class="mb-4 table-responsive">
      <table class="table">
        <!--TODO braucht noch bissi Ã¼berarbtung -->
        <thead [class.disable-sticky]="selectedSubject" class="sticky-top">
        <tr>
          <th class="table-header">Subject Name</th>
          <th class="table-header text-right">Actions</th>
        </tr>
        </thead>
        <tbody *ngIf="loadSubjects">
        <tr *ngFor="let subject of subjects">
          <td>{{ subject.name }}</td>
          <td class="text-right btn-container">
            <div class="btn-group">
              <a class="btn btn-sm responsive-danger-button" type="button" (click)="onDelete(subject.id, $event)">
                <i class="bi bi-trash">delete</i>
              </a>
              <a (click)="onInfo(subject)" data-bs-toggle="popup"
                 data-bs-target="#openSubjectInfo" type="button" class="btn btn-sm responsive-info-button ">
                <i class="bi bi-info-lg"> &#9432;</i>
              </a>
              <a (click)="onEdit(subject)" data-bs-toggle="popup"
                 data-bs-target="#openSubjectInfo2" type="button" class="btn btn-sm responsive-warning-button"
                 aria-label="Edit Subject">
                <i class="bi bi-pencil">&#x270F;</i>
              </a>
            </div>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="popup popup-overlay" (click)="closeSubjectInfo()" id="openSubjectInfo" tabindex="-1"
     aria-labelledby="openSubjectInfoLabel" aria-hidden="true" *ngIf="info">
  <div class="popup-container" (click)="$event.stopPropagation()">
    <div class="header-container">
      <h2>Subject Info:</h2>
    </div>
    <div class="subject-details">
      <div class="detail-row"><span class="detail-label">Number:</span> <span
        *ngIf="selectedSubject">{{ selectedSubject.number }}</span></div>
      <div class="detail-row"><span class="detail-label">Semester:</span> <span
        *ngIf="selectedSubject">{{ selectedSubject.semester }}</span></div>
      <div class="detail-row"><span class="detail-label">Title:</span> <span
        *ngIf="selectedSubject">{{ selectedSubject.title }}</span></div>
      <div class="detail-row"><span class="detail-label">Type:</span> <span
        *ngIf="selectedSubject">{{ selectedSubject.type }}</span></div>
      <div class="detail-row"><span class="detail-label">Description:</span> <span
        *ngIf="selectedSubject">{{ selectedSubject.description }}</span></div>
      <div class="detail-row"><span class="detail-label">URL:</span> <span
        *ngIf="selectedSubject">{{ selectedSubject.url }}</span></div>
      <div class="button-container">
        <a class="btn btn-danger w-50" role="button" (click)="onDelete(selectedSubject.id, $event)">Delete</a>
        <a (click)="onEdit(null)" data-bs-toggle="popup"
           data-bs-target="#openSubjectInfo2" type="button" class="btn btn-edit w-50" role="button">Edit</a>
      </div>
    </div>
  </div>
</div>

<div class="popup popup-overlay" (click)="closeSubjectEdit()" id="openSubjectInfo2" tabindex="-1"
     aria-labelledby="openSubjectInfoLabel" aria-hidden="true" *ngIf="edit">
  <div class="popup-container" (click)="$event.stopPropagation()">
    <div class="header-container">
      <h2>Edit Subject:</h2>
    </div>
    <div class="subject-details w-100">
      <div class="detail-row">
        <span class="detail-label">Number:</span>
        <input id="subjectNumber" *ngIf="selectedSubject" [(ngModel)]="selectedSubject.number" class="form-control"/>
      </div>
      <div class="detail-row w-100">
        <span class="detail-label">Semester:</span>
        <input id="subjectSemester" *ngIf="selectedSubject" [(ngModel)]="selectedSubject.semester" class="form-control"/></div>
      <div class="detail-row">
        <span class="detail-label">Title:</span>
        <input id="subjectTitle" *ngIf="selectedSubject" [(ngModel)]="selectedSubject.title" class="form-control"/></div>
      <div class="detail-row">
        <span class="detail-label">Type:</span>
        <input id="subjectType" *ngIf="selectedSubject" [(ngModel)]="selectedSubject.type" class="form-control"/></div>
      <div class="detail-row">
        <span class="detail-label">Description:</span>
        <input id="subjectDescription" *ngIf="selectedSubject" [(ngModel)]="selectedSubject.description" class="form-control"/></div>
      <div class="detail-row"><span class="detail-label">URL:</span>
        <textarea id="subjectUrl" *ngIf="selectedSubject" [(ngModel)]="selectedSubject.url" class="form-control"></textarea></div>
      <div class="detail-row"><span class="detail-label"></span>
        <span class="pt-3"><strong>Pleas be careful when editing any Subjects. It can have major effects on the User Experience!</strong></span> </div>
      <div class="button-container">
        <a class="btn btn-danger w-50" role="button" (click)="onDelete(selectedSubject.id, $event)">Delete</a>
        <a class="btn btn-edit w-50" role="button" (click)="saveSelectedSubject($event)">Save</a>
      </div>
    </div>
  </div>
</div>

